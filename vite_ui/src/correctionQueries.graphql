# /exercises/:exerciseId/solutions/:username/correctSolution

fragment SolutionNodeMatch on SolutionNodeMatch {
  sampleNodeId
  userNodeId
  matchStatus
  certainty
  paragraphCitationCorrectness
  explanationCorrectness
  paragraphCitationAnnotations {
    ...ParagraphCitationAnnotation
  }
  explanationAnnotation {
    ...ExplanationAnnotation
  }
}

fragment SolutionNode on SolutionNode {
  id
  childIndex
  isSubText
  text
  applicability
  parentId
}

fragment SampleSolutionNode on FlatSampleSolutionNode {
  ...SolutionNode
  subTexts
}

fragment Annotation on Annotation {
  id
  errorType
  importance
  startIndex
  endIndex
  text
}

fragment ParagraphCitationAnnotation on ParagraphCitationAnnotation {
  awaitedParagraph
  correctness
  citedParagraph
  explanation
}

fragment ExplanationAnnotation on ExplanationAnnotation {
  sampleNodeId
  userNodeId
  annotation
}

fragment FlatUserSolutionNode on FlatUserSolutionNode {
  ...SolutionNode
  annotations {
    ...Annotation
  }
  #paragraphCitationAnnotations {
  #  ...ParagraphCitationAnnotation
  #}
  #explanationAnnotations {
  #  ...ExplanationAnnotation
  #}
}

fragment CorrectionSummary on CorrectionSummary {
  comment
  points
}

fragment UserSolution on UserSolution {
  # correctionStatus
  userSolutionNodes: nodes {
    ...FlatUserSolutionNode
  }
  matches {
    ...SolutionNodeMatch
  }
  correctionSummary {
    ...CorrectionSummary
  }
}

query NewCorrection($exerciseId: Int!, $username: String!) {
  exercise(exerciseId: $exerciseId) {
    sampleSolution {
      ...SampleSolutionNode
    }
    userSolution(username: $username) {
      ...UserSolution
    }
  }
}
