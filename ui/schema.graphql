enum Applicability {
  Applicable
  NotApplicable
  NotSpecified
}

input ChangePasswordInput {
  newPassword: String!
  newPasswordRepeat: String!
  oldPassword: String!
}

type Exercise {
  allUsersWithCorrection: [String!]!
  allUsersWithSolution: [String!]!
  corrected: Boolean!
  correctionForUserAsJson(username: String!): String @deprecated(reason: "Will be removed!")
  flatCorrectionForUser(username: String!): FlatCorrection!
  flatSampleSolution: [FlatSolutionNode!]!
  flatUserSolution(username: String!): [FlatSolutionNode!]
  id: Int!
  sampleSolutionAsJson: String! @deprecated(reason: "TODO!")
  solutionForUserAsJson(username: String!): String @deprecated(reason: "Will be removed!")
  solutionSubmitted: Boolean!
  text: String!
  title: String!
}

type ExerciseMutations {
  submitCorrection(correctionInput: GraphQLCorrectionInput!): Boolean!
  submitSolution(userSolution: GraphQLUserSolutionInput!): Boolean!
}

type FlatCorrection {
  matchingResult: [FlatSolutionNodeMatch!]!
  sampleSolution: [FlatSolutionNode!]!
  userSolution: [FlatSolutionNode!]!
}

type FlatSolutionNode {
  applicability: Applicability!
  childIndex: Int!
  id: Int!
  parentId: Int
  subTexts: [SolutionNodeSubText!]!
  text: String!
}

type FlatSolutionNodeMatch {
  sampleNodeId: Int!
  userNodeId: Int!
}

input GraphQLCorrectionInput {
  correctionAsJson: String!
  username: String!
}

input GraphQLExerciseInput {
  sampleSolutionAsJson: String!
  text: String!
  title: String!
}

input GraphQLUserSolutionInput {
  maybeUsername: String
  solutionAsJson: String!
}

input LoginInput {
  password: String!
  username: String!
}

type Mutation {
  changePassword(changePasswordInput: ChangePasswordInput!): Boolean!
  claimJwt(ltiUuid: String!): String
  createExercise(exerciseInput: GraphQLExerciseInput!): Int!
  exerciseMutations(exerciseId: Int!): ExerciseMutations
  login(loginInput: LoginInput!): String!
  register(registerInput: RegisterInput!): String!
}

type Query {
  exercise(exerciseId: Int!): Exercise!
  exercises: [Exercise!]!
}

input RegisterInput {
  password: String!
  passwordRepeat: String!
  username: String!
}

type SolutionNodeSubText {
  applicability: Applicability!
  text: String!
}