type AdminMutations {
  changeUserRights(rights: Rights!, username: String!): Rights!
}

type AdminQueries {
  usersByPrefix(prefix: String!): [String!]!
  usersWithRights(rights: Rights!): [String!]!
}

enum Applicability {
  Applicable
  NotApplicable
  NotSpecified
}

type Exercise {
  allUsersWithSolution: [String!]!
  id: Int!
  sampleSolution: [FlatSolutionNode!]!
  solutionForUser(username: String!): [FlatSolutionNode!]!
  solutionSubmitted: Boolean!
  text: String!
  title: String!
}

type ExerciseMutations {
  submitSolution(solution: SubmitSolutionInput!): Boolean!
  userSolutionMutations(username: String!): UserSolutionMutations!
}

type FlatSolutionNode {
  applicability: Applicability!
  id: Int!
  parentId: Int
  subTexts: [SolutionNodeSubText!]!
  text: String!
}

input FlatSolutionNodeInput {
  applicability: Applicability!
  id: Int!
  parentId: Int
  subTexts: [SolutionEntrySubTextInput!]!
  text: String!
}

type Mutation {
  adminMutations: AdminMutations!
  exerciseMutations(exerciseId: Int!): ExerciseMutations
}

input NodeMatchInput {
  matchId: Int!
  parentMatchId: Int
  sampleNodeId: Int!
  userNodeId: Int!
}

type Query {
  adminQueries: AdminQueries!
  exercise(exerciseId: Int!): Exercise
  exercises: [Exercise!]!
}

enum Rights {
  Admin
  Corrector
  Student
}

input SolutionEntrySubTextInput {
  applicability: Applicability!
  text: String!
}

type SolutionNodeSubText {
  applicability: Applicability!
  text: String!
}

input SubmitSolutionInput {
  solution: [FlatSolutionNodeInput!]!
  username: String
}

type UserSolutionMutations {
  saveMatch(nodeMatchInput: NodeMatchInput!): Boolean!
}